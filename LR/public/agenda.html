<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Agenda</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/base.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/agenda.css') }}">
</head>
<body class="consultas">
    <header class="consultas-header">
        <div class="consultas-header__content">
            <div>
                <p class="consultas-header__eyebrow">Painel da equipe</p>
                <h1 class="consultas-header__title">📋 Consulta de agendamentos</h1>
                <p class="consultas-header__subtitle">Encontre horários rapidamente, filtre por status e acompanhe cada cliente.</p>
            </div>
            <a href="/logout" class="consultas-header__logout">Sair</a>
        </div>
    </header>

    <main class="consultas-main">
        <section class="filters-panel" aria-label="Filtros de agendamento">
            <div class="filters-panel__grid">
                <label class="filter-field" for="prof-select">
                    <span class="filter-field__label">Profissional</span>
                    <select id="prof-select" onchange="carregarAgendamentos()">
                        <option value="">Todos</option>
                        <!-- Preenchido via JS -->
                    </select>
                </label>

                <div class="filter-field">
                    <span class="filter-field__label">Status</span>
                    <div class="status-filter">
                        <button id="status-dropdown-btn" class="status-dropdown-btn" type="button" onclick="toggleStatusDropdown()" aria-haspopup="true" aria-expanded="false">Todos</button>
                        <div id="status-dropdown-content" class="status-dropdown-content" role="menu" aria-label="Filtrar por status">
                            <!-- Preenchido dinamicamente via JS -->
                        </div>
                    </div>
                </div>

                <div class="filter-field filter-field--range">
                    <span class="filter-field__label">Período</span>
                    <div class="filter-field__range">
                        <input type="date" id="start-date" onchange="atualizarEndDate(); carregarAgendamentos()" aria-label="Data inicial">
                        <span class="range-separator" aria-hidden="true">até</span>
                        <input type="date" id="end-date" onchange="carregarAgendamentos()" aria-label="Data final">
                    </div>
                </div>
            </div>

            <div class="filters-panel__actions">
                <button type="button" class="filters-panel__button" onclick="carregarAgendamentos()">Atualizar lista</button>
            </div>
        </section>

        <section class="consultas-summary" aria-live="polite">
            <h2 id="titulo-agendamentos" class="consultas-summary__title">Carregando agendamentos...</h2>
        </section>

        <div id="loading" class="feedback-block" style="display:none;">
            <span class="feedback-block__icon" aria-hidden="true">⏳</span>
            <span>Carregando agendamentos...</span>
        </div>
        <div id="error" class="feedback-block feedback-block--error" style="display:none;"></div>

        <section id="tabela-agendamentos" class="booking-board" style="display:none;" aria-live="polite">
            <div id="corpo-tabela" class="booking-board__list" role="list"></div>
        </section>
    </main>

    <div id="modal-detalhes" class="modal" role="dialog" aria-modal="true" aria-labelledby="modal-detalhes-titulo" style="display:none;">
        <div class="modal-content">
            <button class="close" type="button" onclick="fecharModal(event)" aria-label="Fechar">&times;</button>
            <h2 id="modal-detalhes-titulo">Detalhes do agendamento</h2>
            <div id="conteudo-modal"></div>
            <form id="update-form" class="modal-form" style="display:none;">
                <div class="form-group">
                    <label for="new-date">Nova data</label>
                    <input type="date" id="new-date" name="new-date" required>
                </div>
                <div class="form-group">
                    <label for="new-time">Novo horário</label>
                    <input type="time" id="new-time" name="new-time" required>
                </div>
                <div class="form-group">
                    <span class="form-group__label">Serviços</span>
                    <div id="services-checkboxes" class="checkbox-group"></div>
                </div>
                <div class="form-group">
                    <label for="status">Status</label>
                    <select id="status" name="status" required>
                        <option value="🔴Desistência">🔴Desistência</option>
                        <option value="🟡Pendente">🟡Pendente</option>
                        <option value="🟢Atendido">🟢Atendido</option>
                        <option value="🔵Agendado">🔵Agendado</option>
                        <option value="⚫Pago">⚫Pago</option>
                    </select>
                </div>
                <div class="modal-form__actions">
                    <button type="submit" class="action-btn save-btn">Salvar alterações</button>
                </div>
            </form>
        </div>
    </div>

    <script src="{{ url_for('static', filename='js/base.js') }}"></script>
    <script src="{{ url_for('static', filename='js/agenda.js') }}"></script>
</body>
</html>